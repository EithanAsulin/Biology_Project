<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BIOMIMICRY | BIOLOGY LABS</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Heebo:wght@300;500;800;900&display=swap');
        
        :root {
            --bg-deep: #020202;
            /* Layered Opacity System */
            --panel-bg: rgba(10, 10, 10, 0.75); 
            --item-bg: rgba(255, 255, 255, 0.03);
            --border: rgba(255, 255, 255, 0.08);
        }

        body {
            font-family: 'Heebo', sans-serif;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--bg-deep);
            color: white;
            margin: 0;
            overflow: hidden;
        }
        
        #bg-image {
            position: fixed;
            inset: 0;
            background-image: var(--background-url, url('./0.png'));
            background-size: cover;
            background-position: center;
            z-index: -3;
            transition: background-image 1.2s ease;
            filter: brightness(0.4);
        }

        #bg-gradient-overlay {
            position: fixed;
            inset: 0;
            background: radial-gradient(circle at center, rgba(0,0,0,0) 10%, rgba(0,0,0,0.98) 100%);
            z-index: -2;
        }

        /* THE GHOST PANEL (Opacity & Blur) */
        .main-panel {
            background: var(--panel-bg);
            backdrop-filter: blur(40px) saturate(150%);
            border: 1px solid var(--border);
            border-radius: 44px;
            box-shadow: 0 0 0 1px rgba(255,255,255,0.05), 0 100px 200px -50px rgba(0,0,0,1);
            width: 90vw;
            max-width: 650px;
            min-height: 600px;
            padding: 4rem;
            display: flex;
            flex-direction: column;
            position: relative;
            /* Transition Logic */
            transition: filter 0.6s cubic-bezier(0.4, 0, 0.2, 1), 
                        opacity 0.6s ease, 
                        transform 0.7s cubic-bezier(0.19, 1, 0.22, 1);
        }

        /* THE FIRE/OPACITY TRANSITION */
        .transition-blur {
            filter: blur(80px) brightness(2) contrast(1.2);
            opacity: 0;
            transform: scale(0.94);
        }

        .stagger-in > * { opacity: 0; transform: translateY(20px); }
        .active .stagger-in > * { animation: emerge 0.8s cubic-bezier(0.2, 1, 0.3, 1) forwards; }
        .active .stagger-in > *:nth-child(1) { animation-delay: 0.15s; }
        .active .stagger-in > *:nth-child(2) { animation-delay: 0.25s; }
        .active .stagger-in > *:nth-child(3) { animation-delay: 0.35s; }

        @keyframes emerge { to { opacity: 1; transform: translateY(0); } }

        .btn-lab {
            background: rgba(255,255,255,0.95);
            color: black;
            padding: 1.2rem 3rem;
            border-radius: 100px;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 1.8px;
            transition: all 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
            cursor: pointer;
        }
        .btn-lab:hover { transform: translateY(-3px); box-shadow: 0 20px 40px rgba(255,255,255,0.2); }

        .sortable-item {
            background: var(--item-bg);
            border: 1px solid var(--border);
            padding: 1.2rem;
            border-radius: 18px;
            margin-bottom: 0.8rem;
            cursor: grab;
            transition: background 0.3s, border 0.3s;
        }
        .sortable-item:hover { background: rgba(255,255,255,0.06); border-color: rgba(255,255,255,0.2); }
        .sortable-item.dragging { opacity: 0.1; transform: scale(1.02); }

        .option-card {
            background: var(--item-bg);
            border: 1px solid var(--border);
            padding: 1.3rem;
            border-radius: 18px;
            text-align: center;
            cursor: pointer;
            transition: 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
            display: block;
            margin-bottom: 1rem;
            color: rgba(255,255,255,0.7);
        }
        .option-card:hover { background: rgba(255,255,255,0.08); color: white; }

        input[type="radio"]:checked + .option-card { 
            background: white; 
            color: black; 
            font-weight: 900; 
            transform: scale(1.02);
            box-shadow: 0 10px 30px rgba(255,255,255,0.1);
        }

        input[type="number"], input[type="text"] {
            background: transparent; border-bottom: 2px solid var(--border);
            font-size: 3.5rem; text-align: center; width: 100%; outline: none; 
            color: white; font-weight: 900; padding: 1.5rem;
            transition: border-color 0.3s;
        }
        input:focus { border-color: white; }

        .hidden { display: none !important; }
        .step-dot { width: 5px; height: 5px; border-radius: 50%; background: rgba(255,255,255,0.15); transition: 0.5s ease; }
        .step-dot.active { background: white; box-shadow: 0 0 12px white; transform: scale(1.6); }

        /* DEV MENU */
        #dev-trigger { position: absolute; top: 25px; right: 25px; opacity: 0.15; cursor: pointer; transition: 0.4s; z-index: 100; }
        #dev-trigger:hover { opacity: 1; transform: rotate(45deg); }
        #dev-menu {
            position: absolute; top: 70px; right: 25px;
            background: rgba(5, 5, 5, 0.98); border: 1px solid #333;
            padding: 15px; border-radius: 20px; z-index: 100;
            max-height: 450px; overflow-y: auto; width: 240px;
            box-shadow: 0 30px 60px rgba(0,0,0,0.8);
        }
        .skip-btn {
            display: block; width: 100%; text-align: right; padding: 12px; font-size: 11px; color: #777;
            border-bottom: 1px solid #222; transition: 0.3s;
        }
        .skip-btn:hover { color: white; background: #111; }
    </style>
</head>
<body>

<div id="bg-image"></div>
<div id="bg-gradient-overlay"></div>

<div class="main-panel active" id="ui-card">
    <div id="dev-trigger" onclick="toggleDevMenu()">
        <svg width="20" height="20" fill="white" viewBox="0 0 24 24"><path d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58a.49.49 0 0 0 .12-.61l-1.92-3.32a.488.488 0 0 0-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54a.484.484 0 0 0-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58a.49.49 0 0 0-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/></svg>
    </div>
    <div id="dev-menu" class="hidden"></div>
    
    <div id="start-screen" class="stagger-in flex flex-col items-center justify-center text-center h-full">
        <p class="text-white/30 tracking-[0.5em] mb-3 text-[9px] font-black uppercase">עבודה בנושא ביומימיקרי</p>
        <h1 class="text-6xl font-black mb-8 tracking-tighter">BIOLOGY LABS</h1>
        <p class="text-white/50 text-lg mb-12 max-w-sm leading-relaxed">
            בורכים הבאים למחקר בנושא ביומימיקרי, <br>
            במחקר זה תעברו ב-6 יבשות שונות בזמן שאתם עונים על 3 שאלות קשורות ליבשת בכל חדר. <br><br>
            עבודה זאת מתוכננת ב-HTML, CSS, Javascript לא שומש אף Template ביצירה של העבודה, עבודה זאת מוגשת על ידי איתן אסולין.
        </p>
        <button onclick="fireTransition('start-screen', 'game-screen', loadPuzzle)" class="btn-lab">START</button>
    </div>

    <div id="game-screen" class="hidden h-full flex flex-col">
        <div class="flex justify-between items-center mb-12 stagger-in">
            <div id="step-dots" class="flex gap-2.5"></div>
            <span id="room-name" class="text-[10px] uppercase tracking-[0.2em] font-black text-white/30"></span>
        </div>
        <div id="content-area" class="flex-grow stagger-in">
            <h2 id="question-text" class="text-3xl font-bold mb-12 leading-tight"></h2>
            <div id="options-box"></div>
        </div>
        <div class="mt-12 flex flex-col items-center stagger-in">
            <p id="feedback" class="h-6 text-[10px] font-black mb-5 tracking-[0.3em] uppercase text-white/40"></p>
            <button onclick="checkAnswer()" class="btn-lab w-full">בדיקה</button>
        </div>
    </div>

    <div id="code-screen" class="hidden stagger-in flex flex-col items-center justify-center text-center h-full">
        <p class="text-white/20 tracking-[0.4em] mb-4 uppercase text-[10px] font-bold">מספר/אות חדשה גולה!</p>
        <div id="big-code" class="text-[11rem] font-black my-4 text-white drop-shadow-[0_0_30px_rgba(255,255,255,0.3)]"></div>
        <button onclick="fireTransition('code-screen', 'game-screen', loadPuzzle)" class="btn-lab">המשך לחדר הבא</button>
    </div>

    <div id="lock-screen" class="hidden stagger-in flex flex-col items-center justify-center h-full">
        <h2 class="text-[11px] font-black mb-16 text-white/30 uppercase tracking-[0.5em] text-center">סיסמה סופית</h2>
        <input type="text" id="final-input" maxlength="6" placeholder="000000" class="tracking-[2.5rem] placeholder:opacity-10">
        <button onclick="verifyFinal()" class="btn-lab mt-20 w-full">בדוק</button>
    </div>

    <div id="win-screen" class="hidden stagger-in flex flex-col items-center justify-center text-center h-full">
        <h2 class="text-7xl font-black mb-6 uppercase italic tracking-tighter">SUCCESS</h2>
        <p class="text-white/40 mb-12 text-xl font-light">הסיסמה הסופית נכונה!</p>
        <button onclick="location.reload()" class="btn-lab">התחל מחדש</button>
    </div>
</div>

<script>
    const puzzles = [
        { type: "mcq", subject: "AFRICA SECTOR", question: "איזה מבנה אפריקאי שימש השראה לאוורור טבעי בבניין ה-Eastgate Centre?", answer: "קן טרמיטים", options: ["קן נשרים", "קן טרמיטים", "מחילת חולד", "מבנה אלמוגים"] },
        { type: "number", subject: "AFRICA SECTOR", question: "מהו הגובה במטרים של הג'ירף שצווארו משמש מודל לזרועות רובוטיות?", answer: "5" },
        { type: "sort", subject: "AFRICA SECTOR", question: "סדרו את פתרונות הביומימיקרי מהבסיסי למתקדם:", answer: ["חיקוי צבעי הסוואה (זיקית)", "איסוף מים מהאוויר (חיפושית נמיב)", "ייצור חום פנימי (צבוע)"], options: ["איסוף מים מהאוויר (חיפושית נמיב)", "חיקוי צבעי הסוואה (זיקית)", "ייצור חום פנימי (צבוע)"] },
        
        { type: "mcq", subject: "EUROPE SECTOR", question: "איזו ציפור אירופאית שימש השראה לחרטום רכבת הקליע?", answer: "שלדג", options: ["נקר", "בז נודד", "שלדג", "ינשוף"] },
        { type: "number", subject: "EUROPE SECTOR", question: "כמה אחוזים מכוח המשיכה יכולים חרקי מים להחזיק בכפות רגליהם?", answer: "1000" },
        { type: "mcq", subject: "EUROPE SECTOR", question: "איזה צמח שימש השראה להמצאת ה'סקוטש' (Velcro)?", answer: "זרעי כלב שדה", options: ["עלי ליבנה", "זרעי כלב שדה", "עלי ערבה", "אצטרובל"] },
        
        { type: "mcq", subject: "ASIA SECTOR", question: "איזה צמח מים אסיאתי שימש השראה לציפויים מנקים את עצם?", answer: "לוטוס", options: ["במבוק", "לילי מים", "אורז", "לוטוס"] },
        { type: "number", subject: "ASIA SECTOR", question: "כמה כנפיים יש לפרפר הטורנינג אסיאתי בעל הצבע המבני?", answer: "4" },
        { type: "sort", subject: "ASIA SECTOR", question: "סדר את המבנים מהעמידות הנמוכה ביותר לגבוהה ביותר:", answer: ["מבנה עץ פשוט", "מגדל עץ יפני (פאגודה)", "קן צרעה"], options: ["מגדל עץ יפני (פאגודה)", "קן צרעה", "מבנה עץ פשוט"] },
        
        { type: "number", subject: "AUSTRALIA SECTOR", question: "כמה רגליים אחוריות משמשות את הקנגורו לזינוק?", answer: "2" },
        { type: "mcq", subject: "AUSTRALIA SECTOR", question: "עור הכריש האוסטרלי שימש השראה למניעת הצטברות של מה?", answer: "חיידקים ואצות", options: ["לכלוך ושומן", "חיידקים ואצות", "חלודה", "שריטות"] },
        { type: "sort", subject: "AUSTRALIA SECTOR", question: "סדר שיטות קליטת מים מהיעילה ביותר לפחות יעילה לאדם:", answer: ["שמירת טל על השריון (לטאת קוצנית)", "הזעה פנימית (קואלה)", "שתייה רגילה (ברווז)"], options: ["הזעה פנימית (קואלה)", "שתייה רגילה (ברווז)","שמירת טל על השריון (לטאת קוצנית)"] },

        { type: "mcq", subject: "AMERICA SECTOR", question: "מהו היסוד שהופך את שיני הבונה לקשות ומתחדשות כמודל לכלי חיתוך?", answer: "ברזל", options: ["סידן", "ברזל", "מגנזיום", "אבץ"] },
        { type: "number", subject: "AMERICA SECTOR", question: "כמה מעלות יכולה ציפור הקוליברי להסיט את כנפיה כדי לרחף?", answer: "180" },
        { type: "mcq", subject: "AMERICA SECTOR", question: "איזה בעל חיים שימש השראה לגנרטורים המופעלים ע״י תנועת זנב?", answer: "צלופח חשמלי", options: ["תנין", "דולפין", "צלופח חשמלי", "פיראנה"] },

        { type: "sort", subject: "ANTARCTICA SECTOR", question: "סדרו את מנגנוני הבידוד מהיעיל ביותר לפחות:", answer: ["שכבת אוויר נוצות (פינגווין)", "שכבת שומן עבה (כלב ים)", "פרווה חלולה (דוב קוטב)"], options: ["שכבת שומן עבה (כלב ים)", "פרווה חלולה (דוב קוטב)", "שכבת אוויר נוצות (פינגווין)"] },
        { type: "number", subject: "ANTARCTICA SECTOR", question: "כמה אחוזים מקרני השמש מחזירה מעטפת הקרח (אלבדו)?", answer: "90" },
        { type: "mcq", subject: "ANTARCTICA SECTOR", question: "דג הקרח באנטארקטיקה משמש השראה למה?", answer: "חלבונים נוגדי קיפאון", options: ["מנועי סילון", "חלבונים נוגדי קיפאון", "בדי הסוואה", "חומרי סיכה"] }
    ];

    let currentIdx = 0;
    const codes = ["P", "L", "4", "N", "3", "T"];

    function fireTransition(fromId, toId, callback) {
        const card = document.getElementById('ui-card');
        card.classList.add('transition-blur');
        setTimeout(() => {
            const all = ['start-screen', 'game-screen', 'code-screen', 'lock-screen', 'win-screen'];
            all.forEach(id => document.getElementById(id).classList.add('hidden'));
            if (toId) document.getElementById(toId).classList.remove('hidden');
            if (callback) callback();
            card.classList.remove('active');
            void card.offsetWidth;
            card.classList.remove('transition-blur');
            card.classList.add('active');
        }, 550);
    }

    function loadPuzzle() {
        const p = puzzles[currentIdx];
        document.body.style.setProperty('--background-url', `url('./${Math.floor(currentIdx/3)+1}.png')`);
        document.getElementById('room-name').textContent = p.subject;
        const dots = document.getElementById('step-dots'); dots.innerHTML = '';
        puzzles.forEach((_, i) => {
            const dot = document.createElement('div');
            dot.className = `step-dot ${i === currentIdx ? 'active' : ''}`;
            dots.appendChild(dot);
        });
        document.getElementById('question-text').textContent = p.question;
        const box = document.getElementById('options-box'); box.innerHTML = '';
        if (p.type === 'mcq') {
            p.options.forEach(opt => { box.innerHTML += `<label><input type="radio" name="ans" value="${opt}" class="hidden"><span class="option-card">${opt}</span></label>`; });
        } else if (p.type === 'number') {
            box.innerHTML = `<input type="number" id="num-ans" placeholder="?">`;
        } else if (p.type === 'sort') {
            p.options.sort(() => Math.random() - 0.5).forEach(opt => {
                const item = document.createElement('div'); item.className = 'sortable-item'; item.draggable = true; item.textContent = opt;
                item.addEventListener('dragstart', () => item.classList.add('dragging'));
                item.addEventListener('dragend', () => item.classList.remove('dragging'));
                box.appendChild(item);
            });
            setupSortable(box);
        }
    }

    function setupSortable(container) {
        container.addEventListener('dragover', e => {
            e.preventDefault(); const dragging = document.querySelector('.dragging');
            const afterElement = [...container.querySelectorAll('.sortable-item:not(.dragging)')].reduce((closest, child) => {
                const box = child.getBoundingClientRect(); const offset = e.clientY - box.top - box.height/2;
                return (offset < 0 && offset > closest.offset) ? { offset, element: child } : closest;
            }, { offset: Number.NEGATIVE_INFINITY }).element;
            if (!afterElement) container.appendChild(dragging); else container.insertBefore(dragging, afterElement);
        });
    }

    function checkAnswer() {
        const p = puzzles[currentIdx]; let correct = false;
        if (p.type === 'mcq') {
            const sel = document.querySelector('input[name="ans"]:checked'); if (sel && sel.value === p.answer) correct = true;
        } else if (p.type === 'number') {
            if (document.getElementById('num-ans').value === p.answer) correct = true;
        } else if (p.type === 'sort') {
            const current = [...document.querySelectorAll('.sortable-item')].map(i => i.textContent);
            if (JSON.stringify(current) === JSON.stringify(p.answer)) correct = true;
        }
        const fb = document.getElementById('feedback');
        if (correct) { fb.textContent = "VERIFIED"; fb.style.color = "white"; setTimeout(handleProgression, 700); }
        else { fb.textContent = "DATA ERROR"; fb.style.color = "#ff3333"; setTimeout(() => fb.textContent = "", 1500); }
    }

    function handleProgression() {
        currentIdx++;
        if (currentIdx % 3 === 0 && currentIdx > 0 && currentIdx < puzzles.length) {
            document.getElementById('big-code').textContent = codes[(currentIdx/3)-1];
            fireTransition('game-screen', 'code-screen');
        } else if (currentIdx >= puzzles.length) { fireTransition('game-screen', 'lock-screen'); }
        else { fireTransition('game-screen', 'game-screen', loadPuzzle); }
    }

    function verifyFinal() {
        if (document.getElementById('final-input').value.toUpperCase() === "PL4N3T") fireTransition('lock-screen', 'win-screen');
        else { const input = document.getElementById('final-input'); input.style.color = "red"; setTimeout(() => input.style.color = "white", 1000); }
    }

    function toggleDevMenu() { document.getElementById('dev-menu').classList.toggle('hidden'); }
    function skipTo(idx) { currentIdx = idx; toggleDevMenu(); fireTransition(null, 'game-screen', loadPuzzle); }
    const dev = document.getElementById('dev-menu');
    puzzles.forEach((p, i) => { dev.innerHTML += `<button class="skip-btn" onclick="skipTo(${i})">${p.subject} - Stage ${(i%3)+1}</button>`; });
    dev.innerHTML += `<button class="skip-btn" style="color:#ff3333" onclick="fireTransition(null, 'lock-screen'); toggleDevMenu();">ADMIN OVERRIDE</button>`;
</script>
</body>
</html>
